<div id="CheckoutTopNav" ui-view="checkouttop"></div>
<div class="checkoutContainer row">
	<div class="checkoutContainer-left col-sm-8 col-xs-8 col-md-8 col-lg-8">
		<div class="checkoutSection">
			<uib-accordion close-others="checkout.oneAtATime">
				<uib-accordion-group is-open="checkout.status.delInfoOpen" is-disabled="checkout.status.isFirstDisabled">
					<uib-accordion-heading>
						<h1>1.<span ng-if="checkout.status.isFirstDisabled">
							<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
								 viewBox="0 0 18.3 18.3" style="enable-background:new 0 0 18.3 18.3;" xml:space="preserve">
								<g>
									<path d="M9.1,1.7C5,1.7,1.7,5,1.7,9.1s3.3,7.4,7.4,7.4s7.4-3.3,7.4-7.4S13.2,1.7,9.1,1.7z M7.7,12.4L4.9,9.5L6,8.4
										l1.7,1.7l4.5-4.5l1.1,1.1L7.7,12.4z"/>
								</g>
							</svg>
							</span> Delivery Information <button ng-click="checkout.deliveryInfoEdit($event)" ng-if="checkout.status.isFirstDisabled">Edit</button></h1>
					</uib-accordion-heading>
					<uib-accordion close-others="checkout.oneAtATime">
						<uib-accordion-group ng-repeat="line in checkout.deliveryInfo track by line.ID" is-open="delInfoRecipient[$index]">
							<uib-accordion-heading>
								<h2>Recipient {{$index+1}} {{line.ShippingAddress.FirstName}} {{line.ShippingAddress.LaststName}} | {{line.ShippingAddress.Zip}}</h2>
							</uib-accordion-heading>
							<div class="col-sm-6 col-xs-6 col-lg-6 col-md-6" ng-show="!checkout.isAddrShow{{$index}}">
								<h3>Delivery Address</h3>
								<p ng-click="checkout.viewAddrBook($index)" class="view-addr">View Address Book +</p>
								<div class="check-top inline-blk">
									<p>First Name</p>
									<input type="text" ng-model="line.ShippingAddress.FirstName"></input>
								</div>
								<div class="check-top inline-blk">
									<p>Last Name</p>
									<input type="text" ng-model="line.ShippingAddress.LastName"></input>
								</div>
								<div class="radio-grp check-top col-xs-12 col-sm-12 col-md-12 col-lg-12">
									<label class="radio-inline"><input type="radio" name="optradio{{$index}}" ng-model="line.xp.addressType" ng-click="checkout.changeAddrType(line)" ng-disabled="{{line.xp.NoDeliveryExInStore}}" value="Residence" />Residence</label>
									<label class="radio-inline"><input type="radio" name="optradio{{$index}}" ng-model="line.xp.addressType" ng-click="checkout.changeAddrType(line)" ng-disabled="{{line.xp.NoDeliveryExInStore}}" value="Hospital" />Hospital</label>
									<label class="radio-inline"><input type="radio" name="optradio{{$index}}" ng-model="line.xp.addressType" ng-click="checkout.changeAddrType(line)" ng-disabled="{{line.xp.NoDeliveryExInStore}}" value="Funeral" />Funeral</label>
									<label class="radio-inline"><input type="radio" name="optradio{{$index}}" ng-model="line.xp.addressType" ng-click="checkout.changeAddrType(line)" ng-disabled="{{line.xp.NoDeliveryExInStore}}" value="Church" />Church</label>
									<!-- <label class="radio-inline"><input type="radio" name="optradio{{$index}}" ng-model="line.xp.addressType" ng-click="checkout.changeAddrType(line)" ng-disabled="{{line.xp.NoDeliveryExInStore}}" value="Shipping" />Standard Shipping</label> -->
									<label class="radio-inline"><input type="radio" name="optradio{{$index}}" ng-model="line.xp.addressType" ng-click="checkout.changeAddrType(line)" ng-disabled="{{line.xp.NoDeliveryExInStore}}" value="School" />School</label>
									<label class="radio-inline"><input type="radio" name="optradio{{$index}}" ng-model="line.xp.addressType" ng-click="checkout.changeAddrType(line)" ng-disabled="{{line.xp.NoDeliveryExInStore}}" value="Will Call" />In-Store Pick Up</label>
								</div>
								<p class="check-top">Zip Code</p>
								<input type="text" ng-model="line.ShippingAddress.Zip" ng-blur="checkout.getDeliveryCharges(line)" ng-readonly="line.xp.addressType=='Will Call' ? true : false"></input>
								<p class="check-top">Address1</p>
								<input type="text" ng-model="line.ShippingAddress.Street1" ng-blur="checkout.getDeliveryCharges(line)" ng-readonly="line.xp.addressType=='Will Call' ? true : false"></input>
								<p class="check-top">Address2(optional)</p>
								<input type="text" ng-model="line.ShippingAddress.Street2" ng-readonly="line.xp.addressType=='Will Call' ? true : false"></input>
								<div class="check-top city-block">
									<p>City</p>
									<input type="text" ng-model="line.ShippingAddress.City" ng-readonly="line.xp.addressType=='Will Call' ? true : false"></input>
								</div>
								<div class="check-top state-block">
									<p class="check-top">State</p>
									<!--<select ng-model="line.ShippingAddress.State">
										<option selected>K</option>
										<option>RNR</option>
									</select>-->
									<input type="text" ng-model="line.ShippingAddress.State" ng-readonly="line.xp.addressType=='Will Call' ? true : false" />
								</div>
								<p class="check-top">Phone Number</p>
								<div class="phone-block">
									<input type="number" ng-model="line.ShippingAddress.Phone1" placeholder="Area Code" />
									<input type="number" ng-model="line.ShippingAddress.Phone2" placeholder="Prefix" />
									<input type="number" ng-model="line.ShippingAddress.Phone3" placeholder="Number" />
								</div>
								<div class="delivery-details">
									<label class="radio-inline"><input type="radio" name="group{{$index}}" ng-model="line.xp.addressType" ng-value="line.xp.addressType!='Will Call' ? line.xp.addressType : 'Residence'">Delivery</label>
									<label class="radio-inline"><input type="radio" ng-click="checkout.getStores(line)" name="group{{$index}}" ng-model="line.xp.addressType" value="Will Call">In-Store Pick Up</label>
									<div ng-if="line.xp.addressType!='Will Call'">
										<p class="check-top">Delivery Date</p>
										<p class="modify" ng-init="checkout.deliveryAdj(line)" ng-if="line.xp.deliveryFeesDtls">
											<span>
												<a tabindex="0" popover-trigger="none" popover-is-open="showDeliveryToolTip" ng-click="showDeliveryToolTip = !showDeliveryToolTip" uib-popover-template="checkout.modifyDeliveryPopover.templateUrl">Modify Delivery</a>
											</span>
										</p>
										    <script type="text/ng-template" id="modifyDeliveryTemplate.html">
												<div class="modify-tooltip check-top" click-outside="checkout.closePopover()">
													<div>
														<p>Delivery Fees</p>
														<!-- <input type="text" ng-model="line.xp.deliveryCharges" /> -->
														<h5 ng-repeat="(key, val) in line.xp.deliveryFeesDtls">{{key}} <b ng-if="key=='ServiceFee' && line.xp.DeliveryMethod=='Mixed'"> (50+ Items)</b><input type="text" value="{{val}}" ng-model="line.xp.deliveryFeesDtls[key]" /></h5>
													</div>
													<div>
														<p>Reason For Adjustment</p>
														<select ng-options="reason for reason in checkout.buyerDtls.xp.deliveryChargeAdjReasons" ng-model="line.xp.deliveryChargeAdjReason">
														</select>
													</div>
												</div>
											</script>
										<ul>
										   <li ng-click="checkout.dateSelect('dt',line,$index)" ng-class="{active:checkout.data{{$index}} == 'dt{{$index}}'}">
												<p>Deliver Today</p>
												<p>{{dt | date:'longDate'}}</p>
												<span>Available</span>
										   </li>
										   <li ng-click="checkout.dateSelect('tom',line,$index)" ng-class="{active:checkout.data{{$index}} == 'tom{{$index}}'}">
												<p>Deliver Tomorrow</p>
												<p>{{tom | date:'longDate'}}</p>
												<span>Available</span>
										   </li>
										   <li ng-class="{active:checkout.data{{$index}} == 'selDate{{$index}}'}">
												<p>Select Date</p>
												<input type="text" ng-model="line.dateVal.Month" placeholder="MM" />
												<input type="text" ng-model="line.dateVal.Date" placeholder="DD" ng-change="checkout.dateSelect()" />
												<input type="text" ng-model="line.dateVal.Year" placeholder="YYYY" />
												<button type="button" ng-click="checkout.toggle(line,$index)" uib-datepicker-popup="dd.MM.yyyy" ng-model="datePicker.date" is-open="checkout.opened" ng-required="true" show-weeks="false" show-button-bar="false" min-date="checkout.initDate" init-date="checkout.initDate">
													<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
														 viewBox="0 0 33 36" style="enable-background:new 0 0 33 36;" xml:space="preserve">

													<g>
														<path d="M0,10.2v20c0,2.7,2.2,4.9,4.9,4.9H28c2.7,0,4.9-2.2,4.9-4.9v-20c0-2.7-2.2-4.9-4.9-4.9h-1v-3
															c0-0.8-0.7-1.5-1.5-1.5c-0.8,0-1.5,0.7-1.5,1.5v6c0,0.7-0.6,1.3-1.3,1.3c-0.7,0-1.3-0.6-1.3-1.3V5.3h-2.6v-3c0-0.8-0.7-1.5-1.5-1.5
															c-0.8,0-1.5,0.7-1.5,1.5v6c0,0.7-0.6,1.3-1.3,1.3c-0.7,0-1.3-0.6-1.3-1.3V5.3h-2.6v-3c0-0.8-0.7-1.5-1.5-1.5
															c-0.8,0-1.5,0.7-1.5,1.5v6c0,0.7-0.6,1.3-1.3,1.3c-0.7,0-1.3-0.6-1.3-1.3V5.3C2.2,5.3,0,7.5,0,10.2z M29.4,29.6
															c0,0.9-0.7,1.6-1.6,1.6H5.4c-0.9,0-1.6-0.7-1.6-1.6V16.7h25.6L29.4,29.6z"/>
														<path d="M19.2,29h-7l2.8-3.7c0.3-0.4,0.6-0.8,0.8-1.1c0.2-0.3,0.4-0.6,0.5-0.9c0.2-0.5,0.4-1,0.4-1.5
															c0-0.3-0.1-0.5-0.2-0.7c-0.1-0.2-0.3-0.2-0.5-0.2c-0.4,0-0.7,0.4-0.7,1.2c0,0,0,0.1,0,0.2c0,0.1,0,0.1,0,0.2h-2.7l0-0.4
															c0-1,0.3-1.8,0.9-2.5c0.6-0.6,1.5-0.9,2.4-0.9c1,0,1.7,0.3,2.3,0.9c0.6,0.6,0.9,1.4,0.9,2.4c0,0.8-0.2,1.6-0.6,2.3
															c-0.2,0.4-0.5,0.8-0.8,1.2c-0.3,0.4-0.7,0.8-1.2,1.3c0.4-0.1,0.8-0.2,1.2-0.2c0.4,0,0.8-0.1,1.3-0.1L19.2,29L19.2,29z"/>
													</g>
													</svg>
												</button>
											</li>
										</ul>
										<p class="delivery-date">Delivery Preference</p>
										<ul>
											<li ng-click="line.xp.deliveryRun='Run1'" ng-class="{active:line.xp.deliveryRun=='Run1'}">
												<p>{{checkout.buyerDtls.xp.DeliveryRuns[0].Run1.Name}}</p>
												<p>{{checkout.buyerDtls.xp.DeliveryRuns[0].Run1.TimeSlot}}</p>
											</li>
											<li ng-click="line.xp.deliveryRun='Run2'" ng-class="{active:line.xp.deliveryRun=='Run2'}">
												<p>{{checkout.buyerDtls.xp.DeliveryRuns[0].Run2.Name}}</p>
												<p>{{checkout.buyerDtls.xp.DeliveryRuns[0].Run2.TimeSlot}}</p>
											</li>
											<li ng-click="line.xp.deliveryRun='Run3'" ng-class="{active:line.xp.deliveryRun=='Run3'}">
												<p>{{checkout.buyerDtls.xp.DeliveryRuns[0].Run3.Name}}</p>
												<p>{{checkout.buyerDtls.xp.DeliveryRuns[0].Run3.TimeSlot}}</p>
											</li>
											<li ng-if="line.xp.addressType=='Funeral' && (line.xp.deliveryDate | date)==(tom | date)" ng-click="line.xp.deliveryRun='Run4'" ng-class="{active:line.xp.deliveryRun=='Run4'}">
												<p>{{checkout.buyerDtls.xp.DeliveryRuns[0].Run4.Name}}</p>
												<p>{{checkout.buyerDtls.xp.DeliveryRuns[0].Run4.TimeSlot}}</p>
												<p>${{checkout.buyerDtls.xp.DeliveryRuns[0].Run4.charge}}</p>
											</li>
										</ul>
									</div>
									
									<div ng-if="line.xp.addressType=='Will Call'" class="select-store">
										 <p>Select Store</p>
											 <!--<select>
												<option ng-repeat="store in storeNames" value="{{store.storeName}}" ng-model="line.selected" ng-selected="store.storeName==line.xp.storeName">{{store.storeName}}</option>
											 </select>-->
											 <input type="search" ng-model="line.xp.storeName" ng-value="line.xp.addressType=='Will Call' ? line.xp.storeName : ''" uib-typeahead="st for st in storeNames | filter:$viewValue" typeahead-on-select="checkout.addStoreAddress($item, line)" />
										 <p>
										<fieldset id="group2">
											<label class="radio-inline"><input type="radio" name="group2" ng-model="checkout.fromStoreOrOutside" value="1">Product is coming from my store</label>
											<label class="radio-inline"><input type="radio" name="group2" ng-model="checkout.fromStoreOrOutside" value="2">Product is coming from somewhere else</label>
										</fieldset>
										</p>
									</div>
								</div>
							</div>
							<div class="saved-addr col-sm-6 col-xs-6 col-lg-6 col-md-6" ng-show="checkout.isAddrShow{{$index}}">
									<h3>Saved Delivery Address</h3>
								<uib-accordion close-others="checkout.oneAtATime">
									<uib-accordion-group ng-repeat="addr in addressesList | limitTo: limit" is-open="addr.isAddrOpen" ng-click="checkout.selectedAddr(line,addr)">
										<uib-accordion-heading>
											<input type="checkbox" ng-checked="addr.isAddrOpen" /> {{addr.FirstName}} {{addr.LastName}} | {{addr.Zip}} <span ng-if="defualtAddressID==addr.ID">(Default)</span>
										</uib-accordion-heading>
										<div ng-show="!checkout.isDeliAddrShow{{$index}}" class="saved-delivery-addr">	
											<a ng-click="checkout.deliveryAddr($index)">Edit</a>
											<p>{{addr.Street1}}</p>
											<p>{{addr.Street2}}</p>
											<p>{{addr.Zip}}</p>
											<p>{{addr.Phone}}</p>
										</div>
										<div ng-show="checkout.isDeliAddrShow{{$index}}">
											
											<div class="add-new-addr col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<div class="name check-top col-xs-6 col-sm-6 col-md-6 col-lg-6">
													<p>First Name</p>
													<input type="text" ng-model="addr.FirstName" />
												</div>
												<div class="name check-top col-xs-6 col-sm-6 col-md-6 col-lg-6">
													<p>Last Name</p>
													<input type="text" ng-model="addr.LastName" />
												</div>
												<!--<div class="radio-grp check-top col-xs-12 col-sm-12 col-md-12 col-lg-12" ng-init="addressType='Residence'">
													<label><input type="radio" name="optradio" ng-model="addressType" value="Residence" />Residence</label>
													<label><input type="radio" name="optradio" ng-model="addressType" value="Hospital" />Hospital</label>
													<label><input type="radio" name="optradio" ng-model="addressType" value="FuneralorChurch" />Church/Funeral</label>
													<label><input type="radio" name="optradio" ng-model="addressType" value="Shipping" />Standard Shipping</label>
													<label><input type="radio" name="optradio" ng-model="addressType" value="School" />School</label>
													<label><input type="radio" name="optradio" ng-model="addressType" value="Will Call" />Will Call</label>
												</div>-->
												<div class="zip-code check-top col-xs-12 col-sm-12 col-md-12 col-lg-12">
													<p class="check-top">Zip Code</p>
													<input type="number" ng-model="addr.Zip" ng-blur="GetCityState(addr)" />
												</div>
												<p class="check-top">Address1</p>
												<input type="text" ng-model="addr.Street1" />
												<p class="check-top">address2</p>
												<input type="text" ng-model="addr.Street2" />
												<div class="city check-top col-xs-12 col-sm-12 col-md-12 col-lg-12">
													<div class="location col-xs-6 col-sm-6 col-md-6 col-lg-6">
														<p>City</p>
														<input type="text" ng-model="addr.City" />
													</div>
													<div class="location col-xs-6 col-sm-6 col-md-6 col-lg-6">
														<p>State</p>
														<!--<select ng-model="addr.State">
															<option selected>K</option>
															<option>RNR</option>
														</select>-->
														<input type="text" ng-model="addr.State" />
													</div>
												</div>
												<div class="phone-block check-top col-xs-12 col-sm-12 col-md-12 col-lg-12">
													<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
														<p>Phone Number</p>
														<div>
															<input type="number" ng-model="addr.Phone1" placeholder="Area Code" />
															<input type="number" ng-model="addr.Phone2" placeholder="Prefix" />
															<input type="number" ng-model="addr.Phone3" placeholder="Number" />
														</div>
													</div>
													<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
														<button ng-click="checkout.UpdateAddress(addr,$index)">Save</button>
													</div>
												</div>
											</div>
											
										</div>
									</uib-accordion-group>
								</uib-accordion>
								<div class="more-link">
									<p ng-click="checkout.viewMore()">View More+ </p>
									<p ng-click="checkout.newAddress($index)">Add a New Address+</p>
								</div>
								<!-- Add a new address -->
								<div class="add-new-addr col-xs-12 col-sm-12 col-md-12 col-lg-12" ng-show="showNewAddress{{$index}}">
									<div class="name check-top col-xs-6 col-sm-6 col-md-6 col-lg-6">
										<p>First Name</p>
										<input type="text" ng-model="addr.FirstName"/>
									</div>
									<div class="name check-top col-xs-6 col-sm-6 col-md-6 col-lg-6">
										<p>Last Name</p>
										<input type="text" ng-model="addr.LastName"/>
									</div>
									<!-- <div class="radio-grp check-top col-xs-12 col-sm-12 col-md-12 col-lg-12" ng-init="addressTypeN='Residence'">
										<label class="radio-inline"><input type="radio" name="optradioN{{$index}}" ng-model="addressTypeN" value="Residence" />Residence</label>
										<label class="radio-inline"><input type="radio" name="optradioN{{$index}}" ng-model="addressTypeN" value="Hospital" />Hospital</label>
										<label class="radio-inline"><input type="radio" name="optradioN{{$index}}" ng-model="addressTypeN" value="Funeral" />Funeral</label>
										<label class="radio-inline"><input type="radio" name="optradioN{{$index}}" ng-model="addressTypeN" value="Church" />Church</label>
										<label class="radio-inline"><input type="radio" name="optradioN{{$index}}" ng-model="addressTypeN" value="Shipping" />Standard Shipping</label>
										<label class="radio-inline"><input type="radio" name="optradioN{{$index}}" ng-model="addressTypeN" value="School" />School</label>
										<label class="radio-inline"><input type="radio" name="optradioN{{$index}}" ng-model="addressTypeN" value="Will Call" />In-Store Pick Up</label>
									</div> -->
									<div class="zip-code check-top col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<p>Zip Code</p>
										<input type="number" ng-model="addr.Zip" ng-blur="GetCityState(addr)" />
									</div>
									<p class="check-top">Address1</p>
									<input type="text" ng-model="addr.Street1" />
									<p class="check-top">address2</p>
									<input type="text" ng-model="addr.Street2" />
									<div class="city check-top col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<div class="location col-xs-6 col-sm-6 col-md-6 col-lg-6">
											<p>City</p>
											<input type="text" ng-model="addr.City" />
										</div>
										<div class="location col-xs-6 col-sm-6 col-md-6 col-lg-6">
											<p>State</p>
											<!--<select ng-model="addr.State">
												<option selected>K</option>
												<option>RNR</option>
											</select>-->
											<input type="text" ng-model="addr.State" />
										</div>
									</div>
									<div class="phone-block check-top col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
											<p>Phone Number</p>
											<div>
												<input type="number" ng-model="addr.Phone1" placeholder="Area Code" />
												<input type="number" ng-model="addr.Phone2" placeholder="Prefix" />
												<input type="number" ng-model="addr.Phone3" placeholder="Number" />
											</div>
										</div>
										<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
											<button ng-click="checkout.CreateAddress(addr,$index)">Save</button>
										</div>
									</div>
								</div>
							</div>
							<div class="delivery-instructions col-lg-6 col-md-6">
								<h3>Delivery Instructions</h3>
								<p class="check-top">Delivery Instructions:</p>
								<textarea rows="3" ng-model="line.xp.deliveryNote"></textarea>
								<div ng-init="cardMsg=false">
									<div class="no-msg">
										<span>Card Message:</span>
										<input type="checkbox" name="cardmessage" ng-model="cardMsg"></input>
										<span>No Message</span>
									</div>
									<div class="line-msgs" ng-class="{'hideItem': !cardMsg}">
										<p>Line1</p>
										<input type="text" ng-model="line.xp.CardMessage.line1"></input>
										<p>Line2</p>
										<input type="text" ng-model="line.xp.CardMessage.line2"></input>
										<p>Line3</p>
										<input type="text" ng-model="line.xp.CardMessage.line3"></input>
										<p>Line4</p>
										<input type="text" ng-model="line.xp.CardMessage.line4"></input>
									</div>
								</div>
								<div class="instruction">
									<b>instruction :</b>
								</div>
							</div>
							<input type="button" ng-value="checkout.deliveryInfo.length == $index+1 ? 'Continue to Payment' : 'Next'" ng-click="checkout.payment(line,$index)" />
						</uib-accordion-group>
					</uib-accordion>
					
				</uib-accordion-group>
				<uib-accordion-group is-open="checkout.status.paymentOpen">
					<uib-accordion-heading>
						<h1>2. Payment</h1>
					</uib-accordion-heading>
					<!-- <input type="button" value="Review Order" ng-click="review()" /> -->
					<div class="payment-method">
						<div class="payment-method-header">
							<h1>Payment Method</h1>
							<div class="payment-tab" ng-click="checkout.paymentOption = 'CreditCard'">Credit Card<span class="selected"></span></div>
							<div ng-click="checkout.paymentOption = 'BachmansCharge'" ng-show="checkout.UserSpendingAcc['Bachman Charges']">Bachman's Charges<span class="selected"></span></div>
							<div ng-click="checkout.paymentOption = 'GiftCard'">Gift Card<span class="selected"></span></div>
							<div ng-click="checkout.paymentOption = 'PurplePerk'" ng-show="checkout.UserSpendingAcc['Purple Perks']">Purple Perks<span class="selected"></span></div>
							<div ng-click="checkout.paymentOption = 'CashCheque'">Cash/Cheque<span class="selected"></span></div>
						</div>
						<!-- credit card -->
						<div class="payment-method-container col-xs-10 col-sm-10 col-md-10 col-lg-10" ng-if="checkout.paymentOption == 'CreditCard'">
                            <div ng-repeat="card in checkout.creditCardsList">
                                <div class="payment-container-header">
                                    <label>
                                        <input type="radio" ng-model="checkout.selectedCard" ng-value="card"/>
                                        <span><i class="fa fa-2x" ng-class="{' fa-cc-amex': card.CardType === 'AmericanExpress', ' fa-cc-mastercard': card.CardType === 'MasterCard', ' fa-cc-visa': card.CardType === 'Visa', ' fa-cc-discover': card.CardType === 'Discover'}"></i></span>
                                        <span>XXXX XXX XXX {{card.PartialAccountNumber}}</span>
                                        <span>{{card.ExpirationDate | date : 'MM/yy' : 'UTC'}}</span>
                                        <span>{{card.CardholderName}}</span>
                                    </label>
                                </div>
                                <div class="payment-container row" ng-if="card === checkout.selectedCard">
                                    <div class="pay-m col-xs-12 col-sm-12 col-md-4 col-lg-4">
                                        <label for="cvv">CVV
                                            <i class="fa fa-question-circle text-muted" uib-tooltip="Three or four digit code located on the back side of your card."></i>
                                        </label>
                                        <input id="cvv" class="form-control" type="number" ng-model="card.CVV"/>
                                    </div>
                                </div>
                            </div>
						</div>
						<!-- Bachmans charges -->
						<div class="payment-method-container charges col-xs-10 col-sm-10 col-md-10 col-lg-10" ng-show="checkout.paymentOption == 'BachmansCharge'">
							<div>
								<div class="payment-container-header">
									<span>Bachman's Charge Limit Available</span>
									<span class="total">{{checkout.UserSpendingAcc['Bachman Charges'].Balance | currency}}</span>
								</div>
								<div class="payment-container row">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<p class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<label><input type="radio" ng-model="BachmansCharges" name="BachmansCharge" value="Full" />use {{checkout.UserSpendingAcc['Bachman Charges'].Balance | currency}} Bachman's Charge</label></p>
										<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
											<p class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
											<label><input type="radio" ng-model="BachmansCharges" name="BachmansCharge" value="Custom" />Enter Custom Charge</label></p>
											<input type="number" ng-model="txtBachmanCharges" class="col-xs-8 col-sm-8 col-md-8 col-lg-8" ng-disabled="BachmansCharges == 'Full'" /><span></span>
										</div>
										<span style="color:red;" ng-if="txtBachmanCharges > checkout.UserSpendingAcc['Bachman Charges'].Balance">You cannot exceed your balance limit...!</span>
										<button ng-disabled="txtBachmanCharges > checkout.UserSpendingAcc['Bachman Charges'].Balance" ng-click="checkout.ApplySpendingAccCharges(checkout.UserSpendingAcc['Bachman Charges'], BachmansCharges, txtBachmanCharges, checkout.orderDtls, 'Bachman Charges')">Apply</button>
									</div>
								</div>
							</div>
						</div>
						<!-- Gift Card -->
						<div class="payment-method-container perk col-xs-10 col-sm-10 col-md-10 col-lg-10" ng-show="checkout.paymentOption == 'GiftCard'">
							<div>
								<div class="payment-container-header col-xs-12 col-sm-12 col-md-12 col-lg-12">
									<span>Gift Card Information</span>
									<!-- <span class="total">{{checkout.UserSpendingAcc['Gift Card'].Balance | currency}}</span> -->
								</div>
								<div class="payment-container row">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<!-- <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> -->
											<!-- <p><label><input type="radio" ng-model="GiftCharges" name="GiftCharge" value="Full" />use {{checkout.UserSpendingAcc['Gift Card'].Balance | currency}} Gift Card balance</label></p> -->
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
													Enter 14 or 16 Digit Gift Card Number
												</p>
												<input ng-model="GiftCardNo" type="text" class="col-xs-6 col-sm-6 col-md-6 col-lg-6" />
											</div>
										<!-- </div> -->
										<!-- <span style="color:red;" ng-if="txtGiftCharges > checkout.UserSpendingAcc['Gift Card'].Balance">You cannot exceed your balance limit...!</span> -->
										<button ng-click="checkout.RedeemGiftCard(GiftCardNo, checkout.orderDtls)">Apply</button>
									</div>
								</div>
							</div>
						</div>
						<!-- cash/cheque -->
						<div class="payment-method-container cheque col-xs-10 col-sm-10 col-md-10 col-lg-10" ng-if="checkout.paymentOption == 'CashCheque'">
							<div>
								<div class="payment-container row">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
											<div>
											<p class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
											<input type="radio" name="CashCharge" value="PayCash" ng-model="checkout.PayCashCheque" />Pay through Cash </p>
											<p class="col-xs-4 col-sm-4 col-md-4 col-lg-4">Amount paid through cash</p>
											<input type="number" ng-disabled="checkout.PayCashCheque == 'PayCheque'" ng-model="checkout.txtPayCash"  class="col-xs-6 col-sm-6 col-md-6 col-lg-6"/><span></span>
											</div>
											<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
												<p class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><input type="radio" name="CashCharge" ng-model="checkout.PayCashCheque" value="PayCheque" />Pay through Cheque</p>
												<p class="col-xs-4 col-sm-4 col-md-4 col-lg-4">Check Number</p>
												<input type="number" class="col-xs-6 col-sm-6 col-md-6 col-lg-6" ng-disabled="checkout.PayCashCheque == 'PayCash'" ng-model="checkout.txtChequeNumber" />
												<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
													<p class="col-xs-5 col-sm-5 col-md-5 col-lg-5">Amount Paid through Cheque</p>
													<input ng-disabled="checkout.PayCashCheque == 'PayCash'" type="number" ng-model="checkout.txtChequeAmt" class="col-xs-6 col-sm-6 col-md-6 col-lg-6"/><span></span>
												</div>
											</div>
										</div>
										<button ng-click="checkout.PayByChequeOrCash(checkout.orderDtls)">Apply</button>
									</div>
								</div>
							</div>
						</div>
						<!-- purple perks -->
						<div class="payment-method-container perk col-xs-10 col-sm-10 col-md-10 col-lg-10" ng-show="checkout.paymentOption == 'PurplePerk'">
							<div>
								<div class="payment-container-header col-xs-12 col-sm-12 col-md-12 col-lg-12">
									<span>Purple Perks balance available</span>
									<span class="total">{{checkout.UserSpendingAcc['Purple Perks'].Balance | currency}}</span>
								</div>
								<div class="payment-container row">
									<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
										<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
											<p><label><input type="radio" name="PurpleCharge" ng-model="PurpleCharges" value="Full" />use {{checkout.UserSpendingAcc['Purple Perks'].Balance | currency}} Purple Perks balance</label></p>
												<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
													<p class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
														<label><input type="radio" ng-model="PurpleCharges" name="PurpleCharge" value="Custom" />
														Enter Custom charge</label>
													</p>
													<input ng-model="txtPurpleCharges" type="number" class="col-xs-6 col-sm-6 col-md-6 col-lg-6" ng-disabled="PurpleCharges == 'Full'" />
												</div>
										</div>
										<span style="color:red;" ng-if="txtPurpleCharges > checkout.UserSpendingAcc['Purple Perks'].Balance">You cannot exceed your balance limit...!</span>
										<button ng-disabled="txtPurpleCharges > checkout.UserSpendingAcc['Purple Perks'].Balance" ng-click="checkout.ApplySpendingAccCharges(checkout.UserSpendingAcc['Purple Perks'], PurpleCharges, txtPurpleCharges, checkout.orderDtls, 'Purple Perks')">Apply</button>
									</div>
								</div>
							</div>
						</div>
						<!-- <input type="button" value="Review Order" ng-click="checkout.review()" />-->
					</div>
				</uib-accordion-group>
				<uib-accordion-group is-open="checkout.status.reviewOpen">
					<uib-accordion-heading>
						<h1>3. Review & Confirm Order</h1>
					</uib-accordion-heading>
					<uib-accordion>
						<uib-accordion-group>
							<uib-accordion-heading>
								<h2 ng-click="checkout.reviewAddress()">Customer Name <button class="review-edit">edit</button></h2>
							</uib-accordion-heading>
							<p>{{checkout.order.FromUserFirstName}} {{checkout.order.FromUserLastName}}</p>
						</uib-accordion-group>
						<uib-accordion-group>
							<uib-accordion-heading>
								<h2>1. Shipping Information <button class="review-edit">edit</button></h2>
							</uib-accordion-heading>
							<ul ng-repeat="line in checkout.deliveryInfo track by line.ID" class="shipping-info">
								<li class="shipping-FirstName"><p>{{line.ShippingAddress.FirstName}} {{line.ShippingAddress.LastName}}</p></li>
								<li class="shipping-Addresses">
									<p>{{line.ShippingAddress.Street1}}</p>
									<p>{{line.ShippingAddress.Street2}}</p>
									<p>{{line.ShippingAddress.City}} {{line.ShippingAddress.State}}</p>
									<p>{{line.ShippingAddress.Country}}</p>
									<p>{{line.ShippingAddress.Zip}}</p>
									<span class="shipping-Phone">{{line.ShippingAddress.Phone}}</span> 
								</li>
								<li class="shipping-Date">
									<p class="shipping-subTitle">Delivery Date</p>
									<p>{{line.xp.deliveryDate | date}}</p>
								</li>
								<li class="shipping-DeliveryPref">
									<p class="shipping-subTitle">Delivery Preference</p>
									<p>{{line.xp.deliveryRun}}</p>
								</li>
							</ul>
						</uib-accordion-group>
						<uib-accordion-group>
							<uib-accordion-heading>
								<h2 ng-click="checkout.reviewAddress()">2. Payment <button class="review-edit">edit</button></h2>
							</uib-accordion-heading>
							<ul>
								<li>
									<span>{{userAddr.address.FirstName}} {{userAddr.address.LastName}}</span>
									<p>{{userAddr.address.Street1}} </p>
									<p>{{userAddr.address.Street2}}</p>
									<p>{{userAddr.address.City}}</p>
									<p>{{userAddr.address.State}} {{userAddr.address.Country}}</p>
									<p>{{userAddr.address.Zip}}</p>
								</li>
								<li>
									<span>
										Credit Card: xxxx xxxx xxxx {{userAddr.card.PartialAccountNumber}}
									</span>
									<span>Card Expires: {{usercard.ExpirationDate | date:'mm/dd'}}</span>
									<span ng-if="checkout.orderDtls.SpendingAccounts.PurplePerk">Purple Perks Points Applied:{{checkout.orderDtls.SpendingAccounts.PurplePerk | currency}}</span>
								</li>
							</ul>
						</uib-accordion-group>
					</uib-accordion>
				</uib-accordion-group>
			</uib-accordion>

			<!-- For Place order button section STARTS -->
			<div class="row review-content">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <button class="place-order" ng-click="checkout.submitOrder()">Place Order</button>
                </div>
            </div>
			<!-- For Place order button section ENDS -->
		</div>
	</div>
	<div class="checkoutContainer-right col-sm-4 col-xs-4 col-md-4 col-lg-4">
		<div class="checkoutOrderSummary">
			<div class="order-total">
				<h1>Order [ {{checkout.lineTotalQty}} items ] <a ui-sref="buildOrder({ID:checkout.order.FromUserID,SearchType:'User',showOrdersummary: true})">Edit</a> </h1>
			</div>
			<uib-accordion close-others="checkout.oneAtATime">
				<uib-accordion-group ng-repeat="(recipient, lineitems) in checkout.recipientsGroup">
					<uib-accordion-heading>
						<div class="checkoutorderhead">
							<p><span>Recipient:</span> {{recipient}}</p>
							<p><span>Zip Code:</span> {{lineitems[0].ShippingAddress.Zip}}</p>
						</div>
					</uib-accordion-heading>
					<div class="ordersummaryproductdata" ng-repeat="item in lineitems">
						<div class="prod-img">
							<img src="assets/images/flowers.jpg">
						</div>
						<div class="prod-details">
							<p>{{item.Product.Name}}</p>
							<p>Item no: 141927</p>
							<p>Type: Deluxe</p>
							<span class="qty">Qty: {{item.Quantity}}</span>
							<span class="price">{{item.LineTotal | currency}}</span>
						</div>
					</div>
                    <!-- <div class="charges-total">
                        <p>Recipient Subtotal: <span>{{ checkout.getRecipientSubTotal(lineitems) | currency }}</span></p>
                        <p>Recipient Tax: <span>{{ checkout.getRecipientTax(lineitems) | currency }}</span></p>
                    </div> -->
				</uib-accordion-group>
				<div class="charges-total">
					<p>Subtotal  <span>{{checkout.order.Subtotal | currency}}</span></p>
					<p>Delivery Charges   <span>{{checkout.order.ShippingCost | currency}} </span></p>
					<p>Estimated Tax   <span>{{checkout.order.TaxCost | currency}} </span></p>
					<p ng-if="checkout.orderDtls.SpendingAccounts.CouponCharges"><button ng-click="checkout.deleteSpendingAcc(checkout.orderDtls, 'CouponCharges')">x</button> Coupon Applied <span>-{{checkout.orderDtls.SpendingAccounts.CouponCharges | currency}} </span></p>
					<p ng-if="checkout.orderDtls.SpendingAccounts.BachmansCharges"><button ng-click="checkout.deleteSpendingAcc(checkout.orderDtls, 'BachmansCharges')">x</button>Bachman’s Charge applied   <span>-{{checkout.orderDtls.SpendingAccounts.BachmansCharges | currency}} </span></p>
					<p ng-if="checkout.orderDtls.SpendingAccounts.GiftCardCharges"><button ng-click="checkout.deleteSpendingAcc(checkout.orderDtls, 'GiftCardCharges')">x</button>Gift Card applied   <span>-{{checkout.orderDtls.SpendingAccounts.GiftCardCharges | currency}} </span></p>
					<p ng-if="checkout.orderDtls.SpendingAccounts.PaidCash"><button ng-click="checkout.deleteSpendingAcc(checkout.orderDtls, 'PaidCash')">x</button>Paid Through Cash   <span>-{{checkout.orderDtls.SpendingAccounts.PaidCash | currency}} </span></p>
					<p ng-if="checkout.orderDtls.SpendingAccounts.ChequeCharges"><button ng-click="checkout.deleteSpendingAcc(checkout.orderDtls, 'ChequeCharges')">x</button>Paid through Cheque   <span>-{{checkout.orderDtls.SpendingAccounts.ChequeCharges | currency}} </span></p>
					<p ng-if="checkout.orderDtls.SpendingAccounts.PurplePerk"><button ng-click="checkout.deleteSpendingAcc(checkout.orderDtls, 'PurplePerk')">x</button>Purple Perks Balance applied   <span>-{{checkout.orderDtls.SpendingAccounts.PurplePerk | currency}} </span></p>
					<p class="total">Total   <span>{{checkout.order.Total | currency}}  </span></p>
				</div>
				<div class="promo-code">
					<p>Apply Promo Code</p>
					<input type="text" ng-model="coupon" /><input type="button" value="Apply" ng-click="checkout.ApplyCoupon(coupon, checkout.orderDtls)" />
				</div>
			</uib-accordion>
		</div>
	</div>
</div>
<div id="CheckoutFooter" ui-view="checkoutbottom"></div>